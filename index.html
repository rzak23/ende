<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ende</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="node_modules/dropify/dist/css/dropify.min.css">
    <link rel="stylesheet" href="style.css">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="node_modules/@fortawesome/fontawesome-free/css/fontawesome.min.css">
    <link rel="stylesheet" href="node_modules/@fortawesome/fontawesome-free/css/solid.min.css">
    <link rel="stylesheet" href="node_modules/@fortawesome/fontawesome-free/css/all.css">
</head>
<body class="bg-ende">
    <div class="container mt-4">
        <ul class="nav nav-tabs" id="tabMenu" role="tablist">
            <li class="nav-item">
                <a href="#enk" data-toggle="tab" role="tab" id="EncryptForm" class="nav-link active" aria-controls="EncryptForm" aria-selected="true">
                    <i class="fas fa-eye-slash"></i>
                    <span>Encryption</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#denk" data-toggle="tab" role="tab" id="DecryptForm" class="nav-link" aria-controls="DecryptForm" aria-selected="true">
                    <i class="fas fa-eye"></i>
                    <span>De-Encryption</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#fhash" data-toggle="tab" role="tab" id="FileHash" class="nav-link" aria-controls="FileHash" aria-selected="true">
                    <i class="fas fa-file-contract"></i>
                    <span>File Hash</span>
                </a>
            </li>
        </ul>
        <div class="tab-content" id="tabMenu">
            <div class="tab-pane fade show active" id="enk" role="tabpanel" aria-labelledby="EncryptForm">
                <form>
                    <div class="form-group">
                        <label for="tipe" class="text-label">Tipe Chiper</label>
                        <select name="chiper" id="tipe" class="form-control">
                            <option value="aes">AES</option>
                            <option value="des">DES</option>
                            <option value="triple-des">Triple DES</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="plain" class="text-label">Plain Text</label>
                        <input type="text" class="form-control" id="plain">
                    </div>
                    <div class="form-group">
                        <label for="key" class="text-label">Key</label>
                        <input type="text" class="form-control" id="key">
                    </div>
                    <div class="form-group">
                        <label for="chiper" class="text-label">Chiper Text</label>
                        <input type="text" class="form-control" id="chiper" disabled>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-primary" onclick="encryption()">
                            <i class="fas fa-lock"></i>
                            <span>Enkripsi</span>
                        </button>
                    </div>
                </form>
            </div>
            <div class="tab-pane fade" id="denk" role="tabpanel" aria-labelledby="DecryptForm">
                <form>
                    <div class="form-group">
                        <label for="tiped" class="text-label">Tipe Chiper</label>
                        <select name="chiper" id="tiped" class="form-control">
                            <option value="aes">AES</option>
                            <option value="des">DES</option>
                            <option value="triple-des">Triple DES</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="chiperd" class="text-label">Chiper Text</label>
                        <input type="text" class="form-control" id="chiperd">
                    </div>
                    <div class="form-group">
                        <label for="keyd" class="text-label">Key</label>
                        <input type="text" class="form-control" id="keyd">
                    </div>
                    <div class="form-group">
                        <label for="plaind" class="text-label">Plain Text</label>
                        <input type="text" class="form-control" id="plaind" disabled>
                    </div>
                    <div class="form-group">
                        <button type="button" class="btn btn-primary" onclick="deencryption()">
                            <i class="fas fa-lock-open"></i>
                            <span>De-Enkripsi</span>
                        </button>
                    </div>
                </form>
            </div>
            <div class="tab-pane fade" id="fhash" role="tabpanel" aria-labelledby="FileHash">
                <form>
                    <div class="form-group">
                        <label for="file" class="text-label">File</label>
                        <input type="file" id="file" class="file" onchange="onFileSelect()" data-show-loader="true" multiple>
                    </div>
                </form>
                    <div class="form-group">
                        <label for="md5" class="text-label">MD5</label>
                        <input type="text" class="form-control" id="md5" disabled>
                    </div>
                    <div class="form-group">
                        <label for="sha1" class="text-label">SHA1</label>
                        <input type="text" class="form-control" id="sha1" disabled>
                    </div>
                    <div class="form-group">
                        <label for="sha256" class="text-label">SHA2(256)</label>
                        <input type="text" class="form-control" id="sha256" disabled>
                    </div>
             </div>
        </div>
        <div class="text-center mt-3">
            <button type="button" data-toggle="modal" data-target="#confirmClose" class="btn btn-danger">
                <i class="fas fa-window-close"></i>
                <span>Tutup Aplikasi</span>
            </button>
        </div>
    </div>
    <!-- Modal Close -->
    <div class="modal fade" role="dialog" id="confirmClose">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    Aplikasi akan ditutup?
                    <br>
                    <a href="javascript:window.close()" class="btn btn-danger">
                        <i class="fas fa-check"></i>
                        <span>Tutup</span>
                    </a>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Close -->

    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="node_modules/dropify/dist/js/dropify.min.js"></script>
    <!-- CryptoJS -->
    <script src="node_modules/crypto-js/crypto-js.js"></script>
    <script src="node_modules/crypto-js/aes.js"></script>
    <script src="node_modules/crypto-js/sha256.js"></script>
    <script src="node_modules/crypto-js/sha1.js"></script>
    <script src="node_modules/crypto-js/md5.js"></script>
    <!-- CryptoJS -->
    <script>
        $(document).ready(function(){
            $('#file').dropify();
        })
        function encryption(){
            var tipe = document.getElementById('tipe').value;
            var p = document.getElementById('plain').value;
            var k = document.getElementById('key').value;

            if(tipe == "aes"){
                var cry = CryptoJS.AES.encrypt(p,k);
            }else if(tipe == "des"){
                var cry = CryptoJS.DES.encrypt(p,k);
            }else if(tipe == "triple-des"){
                var cry = CryptoJS.TripleDES.encrypt(p,k);
            }
            document.getElementById('chiper').value = cry;
        }

        function deencryption(){
            var tipe = document.getElementById('tiped').value;
            var c = document.getElementById('chiperd').value;
            var k = document.getElementById('keyd').value;

            if(tipe == "aes"){
                var dry = CryptoJS.AES.decrypt(c,k);
            }else if(tipe == "des"){
                var dry = CryptoJS.DES.decrypt(c,k);
            }else if(tipe == "triple-des"){
                var dry = CryptoJS.TripleDES.decrypt(c,k);
            }
            document.getElementById('plaind').value = dry.toString(CryptoJS.enc.Utf8);
        }

        function onFileSelect(){
            var reader = new FileReader();

            reader.addEventListener('load',function () {
                var sha256 = CryptoJS.SHA256(CryptoJS.enc.Latin1.parse(this.result));
                var md5 = CryptoJS.MD5(CryptoJS.enc.Latin1.parse(this.result));
                var sha1 = CryptoJS.SHA1(CryptoJS.enc.Latin1.parse(this.result));
                // var md5 = hash.toString(CryptoJS.enc.Hex)
                // console.log(output);
                document.getElementById('md5').value = md5;
                document.getElementById('sha256').value = sha256;
                document.getElementById('sha1').value = sha1;
            });
            reader.readAsBinaryString(document.getElementById('file').files[0]);
        }
    </script>
</body>
</html>